#library(reshape2)
library(matrixStats)
library(mvtnorm)
#--------------------------------------------------------------------
# Init code for question 1
#--------------------------------------------------------------------
rm(list = ls())
# given values
mu_0 <- c(0, 100, -100)
omega_0 <- 0.01 * diag(3)
v_0 <- 1
sigma2_0 <- 0.1
days_in_year <- 365
first_day_of_year <- as.Date("2022-01-01")
#--------------------------------------------------------------------
# load data and plot
#--------------------------------------------------------------------
# load the data
temperature_data <- read_xlsx(path="Linkoping2022.xlsx")
temperature_data$time <- as.numeric(as.Date(temperature_data$datetime) - first_day_of_year) /
days_in_year
temperature_data$time_square <- temperature_data$time ** 2
# plot points to visualize
plot_1a <- ggplot(temperature_data, aes(x = time, y=temp)) +
geom_point(aes(color = "red")) +
ylab("Temperature") + xlab("Time") +
ggtitle("Time vs Temperature") +
scale_color_identity(name = "Colour",
breaks = c("red"),
labels = c("Data"),
guide = "legend") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="bottom")
plot_1a
#--------------------------------------------------------------------
# make a linear regression model
#--------------------------------------------------------------------
linRegModel <- lm(temp ~ time + time_square, data = temperature_data)
summary(linRegModel)
